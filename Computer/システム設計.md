# わかりやすいクラスを作る

### 説明用の変数を使う
コードの意図を変数名で説明する。

### ×破壊的代入をしない
変数を使いまわすこと。

### ドメインオブジェクトを作る
業務で使う用語に合わせて、その用語の関心事に対応するクラスをドメインオブジェクトと呼ぶ。  

### 基本データ型をそのまま使わない
値の範囲を制限する独自のクラスを作成し、プログラムをわかりやすくする。  
値オブジェクト(Value Object)と呼ぶ。  

### 値オブジェクト(Value Object)は不変にする
あるタイミングのオブジェクトの状態を考慮する必要がない。  
インスタンス変数をコンストラクタで決めて、変更する手段を持たせない。  
この設計方法を完全コンストラクタと呼ぶ。  

### コレクション型や配列をそのまま使わない
特定オブジェクトのコレクションをもつ独自クラスを作成し、ロジックを閉じ込める。  
コレクションオブジェクトやファーストクラスコレクションと呼ぶ。  
コレクション操作が散乱せず、プログラムがわかりやすくなる。  

### コレクションオブジェクトは不変にする
完全コンストラクタで設計する。  

### コレクションオブジェクトはコレクションを返却しない
getListやAddなどのメソッドは、新規のコレクションオブジェクトを返却するようにする。  
どうしてもコレクションを返却するときは、unmodifiableListにして返却する。  

### コレクションの要素は値オブジェクト(Value Object)にする

# 場合分けを整理する

### ガード節を書く
else句を書かずに、if文の中でreturn（早期リターン)する。

### 区分ごとのロジックを別クラスに分ける
if文の条件が区分（種別・タイプ）ならば、それらをクラスにしてポリモーフィズムで処理する。

### 区分ごとのインスタンス生成クラスを作成する
区分名を与えれば、区分オブジェクトを取得できるクラスを作成する。  
Javaならば列挙型を使って、valueOfメソッドで取得するとなお良い。それを区分オブジェクトと呼ぶ。  

### 状態の遷移や挙動の可能・不可能をenumで判定する

# 業務ロジックを整理する

### データとロジックを分けない
クラスには、インスタンス変数（データ）を判断/加工/計算するメソッド（ロジック）をまとめる。  
クラスのデータを使う側にロジックを書かない。  

### メソッドは短く書く

### メソッドは必ずインスタンス変数を使う
インスタンス変数を使わず、引数だけを使うメソッドはそのクラスに置くべきロジックでは無い。

### クラスを小さくする
クラスのインスタンス変数が増えると、メソッドも増える。   
メソッドがどのインスタンス変数を使っているかに注目し、同じインスタンス変数を使っているメソッドを1つのグループにする。  
グループを別のクラスに抽出すると、メソッドがそのクラスの全てのインスタンス変数を使っている凝集度が高い状態となり、クラスの意図がはっきりする。  

### クラスが増えたらパッケージで分ける
メソッドのスコープはパッケージプライベート以下にする。

# ドメインモデルで設計する
ドメインオブジェクトの集合＝ドメインモデル

### 業務の関心事をヒト/モノ/コトに分類する
- ヒト  
個人、企業、担当者など
- モノ  
商品、店舗、場所、権利など
- コト  
予約、注文、出荷、キャンセルなど

### コトを時系列でまとめる
（例  
・受注  
・出荷  
・請求  
・入金  

### それぞれのコトで起きてよいこと、起きてはいけないことを考える
その判断と対応が業務ロジックであり、ドメインオブジェクトで作る所になる。

### 業務ロジックをドメインモデルの基本の設計パターンに当てはめて考える
ドメインモデルの設計には基本の4種類がある。
- 口座(Account)パターン  
値と、その妥当性  
- 期日(DueDate)パターン  
期限と、その監視  
- 方針(Policy)パターン  
ルールと、それらの組み合わせ  
- 状態(State)パターン  
状態と、その遷移の妥当性

これらの設計を参考にしてドメインオブジェクトを作る。

### それぞれのコトの関心事からドメインオブジェクトを作っていく
全体を把握していなくても、ボトムアップで部品（ドメインオブジェクト）から作っていく。

### トランザクションスクリプトを避ける
業務ロジックをif文で分岐させるトランザクションスクリプトは、ドメインモデルの設計では出てこない。  
それぞれの業務ロジックを持つドメインオブジェクトがあり、そのドメインオブジェクトを利用する側にも極力if文は出てこない。

### ドメインオブジェクトの基本の設計パターンを利用する
ドメインオブジェクトには基本の4種類がある。  
- 値オブジェクト(Value Object)  
- コレクションオブジェクト  
- 区分オブジェクト  
- enumの集合操作  

これらを作っていく。

### プログラムの自己文書化をする
業務の用語をパッケージ名/クラス名/メソッド名/変数名と一致させる事で、ソースコードで業務の要求仕様を表現すること。  

# Web3層＋ドメインモデルで作成する

![Web3層＋ドメインモデル](../picture/システム設計.PNG "Web3層＋ドメインモデル")

### サービスクラスは登録系と参照系で別クラスにする
サービスクラスは肥大化、複雑化しやすいので小さなクラスを心がける。

### サービスクラスのメソッドは

