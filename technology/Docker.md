## Dockerイメージとコンテナ

### AUFS(AnotherUnionFileSystem)... 
別のファイルシステムを差分として適用できるファイルシステムのこと。  

### Dockerイメージ... 
読み取り専用のファイルシステム（AUFS）レイヤの集合とメタ情報（どのコマンドを実行するか、どのポートを開くか等）。  

### Dockerコンテナの作成... 
Dockerイメージレイヤ群の最上位に書き込み可能なレイヤを追加する。（このタイミングでメタ情報を上書きすることも可能）。  

### Dockerコンテナの起動... 
メタ情報か、`docker run`のパラメータで指定されたプロセスを、隔離されたシステムリソース上で実行する。  

### Dockerコンテナのイメージ化... 
コンテナの最上位レイヤをコミットし読み取り専用にする。


![イメージとコンテナ](/picture/Docker.png "イメージとコンテナ")

## Dockerネットワーク

Linuxは、認識しているNICをポートにすることでブリッジにすることができる。 （このLinuxマシンをブリッジホストという） 
ネットワーク機器のブリッジにはMAC・IPアドレスは必要ないため、ポートにしたブリッジホストのNICのMACアドレスと、割り当てていたIPアドレスは無視されてしまう。  
つまり、もしもブリッジホストのNICが全てポートになった場合、ポート接続先マシンからブリッジホストにアクセスする手段がなくなってしまう。  

そこでブリッジホストに対してMAC・IPアドレスを割り当てることができ、ポート接続先マシンからはそれを利用してアクセスする。  

コンテナからパケットが外に出るときはグローバルIPとして振舞う必要があるのでIPマスカレードする。  
パケットがグローバルIP宛に来たときは、単純にブリッジホストが受け取るので、ポートフォワードでコンテナのデーモンにアクセスする。


![ネットワーク](/picture/Docker2.png "ネットワーク")


## docker run の i, tオプション

![i,tオプション](/picture/Docker.png "i,tオプション")
